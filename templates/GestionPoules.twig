<html lang="fr">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
		<script src="https://unpkg.com/htmx.org@2.0.2" integrity="sha384-Y7hw+L/jvKeWIRRkqWYfPcvVxHzVzn5REgzbawhxAuQGwX1XWe70vji+VSeHOThJ" crossorigin="anonymous"></script>
		<script src="js/RemoveEquipe.js"></script>
		<title>Gestion rencontre</title>
	</head>
	<body>
		{{ include('header.twig') }}
		
			<div id="divResult" class="sticky-top" style="z-index: 10;">
			</div>
		
		<div class="container">
			<div class="row">
				<div class="col">
					{% for tournoi in ListeDesTournois %}
						{% if tournoi.isArchived == 0 %}
							{% if tournoi.id == idTournoi %}
								<a href="gestionPoules.php?id_tournoi={{ tournoi.id }}" class="btn btn-success btn-lg">{{ tournoi.nom }}</a>
							{% else %}
								<a href="gestionPoules.php?id_tournoi={{ tournoi.id }}" class="btn btn-secondary">{{ tournoi.nom }}</a>
							{% endif %}
						{% endif %}
					{% endfor %}
				</div>
			</div>

			<div class="row mt-2">
				<div class="col-lg-6">
				<h4>Choisir la categorie </h4>
				
				
				{% for categorie in ListeDesCategorie %}
				
					{% if categorie.id_categorie == categorieEnCours  %}
					
					<a href="gestionPoules.php?id_tournoi={{ idTournoi }}&categorie={{categorie.id_categorie}}&NbrEquipeParPoule={{categorie.nombre_equipes}}" class="btn btn-success btn-lg">{{categorie.Nom_categorie}} ({{categorie.nombre_equipes}})</a>
					
					
					{% else %}
					<a href="gestionPoules.php?id_tournoi={{ idTournoi }}&categorie={{categorie.id_categorie}}&NbrEquipeParPoule={{categorie.nombre_equipes}}" class="btn btn-secondary btn-lg" >{{categorie.Nom_categorie}} ({{categorie.nombre_equipes}})</a>

					{% endif %}

					
				{% endfor %}
			<br><p>Selectionner le nombre d'équipe par poule</p>
				{% for i in 1..15 %}
						{% if i == nbrEquipe %}
					<a href="gestionPoules.php?id_tournoi={{ idTournoi }}&categorie={{categorieEnCours}}&NbrEquipeParPoule={{i}}" class="btn btn-success btn-lg">{{i}}</a>
						{% else %}
					<a href="gestionPoules.php?id_tournoi={{ idTournoi }}&categorie={{categorieEnCours}}&NbrEquipeParPoule={{i}}" class="btn btn-secondary btn-lg">{{i}}</a>
						{% endif %}
					{% endfor %}
				
				

<div class="container">
  <div class="row">
 
    {% for poule in listeDesPoules %}
      <div class="col-12 mb-4">
        <h3>{{ poule.nom }}</h3>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th class="text-center">Liste des équipes</th>
              <th class="text-center">Rencontres</th>
              <th class="text-center">Matchs par équipe</th>
              <th class="text-center">Equipes </th>
			  <th class="text-center">Nombre de tours </th>
			  <th class="text-center">Nombre de rencontres par Tour</th>
            </tr>
          </thead>
          <tbody>
            <tr>
			<td>
              <ul class="list-unstyled">
                  {% for equipe in poule.equipes %}
                    <li>{{ equipe.nom }}</li>
                  {% endfor %}
                </ul>
			</td>
              <td>{{ (poule.equipes|length * (poule.equipes|length - 1)) // 2 }}</td>
              <td>{{ poule.equipes|length - 1 }}</td>
              
                <td>{{ poule.equipes|length }}</td>
				<td>{{ poule.equipes|length - 1 }}</td>
				<td>{{ poule.equipes|length // 2 }}</td>
              
            </tr>
          </tbody>
        </table>
      </div>
    {% endfor %}
  </div>
</div>

		
		
		{% if nbrEquipe is not null %}
		<br>
		<a hx-get="gestionPoules.php?id_tournoi={{ idTournoi }}&categorie={{categorieEnCours}}&NbrEquipeParPoule={{nbrEquipe}}&creation=ok" 
   hx-target="#divResult" 
   hx-swap="innerHTML" 
   class="btn btn-success btn-lg">
    Creer cette poule ?
</a>

		{% endif %}
			</div>

		{% if modal == 'success' %}
<div id="successModal" class="modal" tabindex="-1" role="dialog" style="display: block;">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Succès</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>La poule a été créée avec succès.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>

</div>
{% endif %}





			
		</div>

		
		<script>
$(document).ready(function(){
    // Vérifie si la modale doit être affichée
    if ($("#successModal").length) {
        $("#successModal").modal('show');
    }
});
</script>
	</body>
</html>
