<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"/>


		<title>Gestion rencontre</title>
	</head>
	<body>
		{{ include('header.twig') }}
		<div class="row">
			<div class="row">
				<div class="col">
					<h3>Selection du tournoi</h3>
					{% for tournoi in ListeDesTournois %}
						<a href="modifierTournoi.php?idTournoi={{ tournoi.id }}" class="btn {% if tournoi.id == tournoiEnCours %}btn-danger{% else %}btn-primary{% endif %}" role="button">{{ tournoi.nom }}</a>
					{% endfor %}
				</div>
				

			</div>
			{% if tournoiEnCours != 0 %}


				<div class="col">
					<div class="container mt-5">
						<h2>Modifier Tournoi</h2>

						<form action="modifierTournoi_traitement.php" method="post">

							<input
							type="hidden" name="idTournoi" value="{{infotournoi.id}}">
							

							<div class="form-group">
								<label for="nom">Nom:</label>
								<input type="text" class="form-control" id="nom" name="nom" value="{{infotournoi.nom}}" readonly>
							</div>

							
							<div class="form-group">
								<label for="heure_debut">Heure de début:</label>
								<input type="time" class="form-control" id="heure_debut" name="heure_debut" value="{{infotournoi.heure_debut}}">
							</div>

							<div class="form-group">
								<label for="pasHoraire">Pas Horaire:</label>
								<input type="number" class="form-control" id="pasHoraire" name="pasHoraire" value="{{infotournoi.pasHoraire}}">
							</div>


						

						
							
							

							{% if infotournoi.isArchived == 1 %}
								{% set isArchived = 'checked' %}
							{% else %}
								{% set isArchived = '' %}
							{%  endif %}


							{% if infotournoi.isVisible == 1 %}
								{% set isVisible = 'checked' %}
							{% else %}
								{% set isVisible = '' %}
							{%  endif %}

							{% if infotournoi.heureIsVisible == 1 %}
								{% set heureIsVisible = 'checked' %}
							{% else %}
								{% set heureIsVisible = '' %}
							{%  endif %}


							{% if infotournoi.IsRankingView == 1 %}
								{% set IsRankingView = 'checked' %}
							{% else %}
								{% set IsRankingView = '' %}
							{%  endif %}


							{% if infotournoi.gestionTables == 1 %}
								{% set gestionTables = 'checked' %}
							{% else %}
								{% set gestionTables = '' %}
							{%  endif %}


							{% if infotournoi.gestionArbitres == 1 %}
								{% set gestionArbitres = 'checked' %}
							{% else %}
								{% set gestionArbitres = '' %}
							{%  endif %}


								
							<div class="form-group">

								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="gestionTables" name="gestionTables" value="{{infotournoi.gestionTables}}" {{ gestionTables }}>
									<label class="form-check-label" for="mySwitch">Gestion des tables ? </label>
								</div>

								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="gestionArbitres" name="gestionArbitres" value="{{infotournoi.gestionArbitres}}" {{ gestionArbitres}}>
									<label class="form-check-label" for="mySwitch">Gestion des arbitres ? </label>
								</div>

								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="isVisible" name="isVisible" value="{{infotournoi.isVisible}}" {{ isVisible }}>
									<label class="form-check-label" for="mySwitch">Tournoi visible du Publique ? (n'affecte pas les tables)</label>
								</div>

								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="isArchived" name="heureIsVisible" value="{{infotournoi.heureIsVisible}}" {{ heureIsVisible }}>
									<label class="form-check-label" for="mySwitch">Horaires visible du Publique ?</label>
								</div>

								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="IsRankingView" name="IsRankingView" value="{{infotournoi.IsRankingView}}" {{ IsRankingView }}>
									<label class="form-check-label" for="mySwitch">Classement visible du publique ?</label>
								</div>

								<div class="form-check form-switch">
									<input class="form-check-input" type="checkbox" id="isArchived" name="isArchived" value="{{infotournoi.isArchived}}" {{ isArchived }}>
									<label class="form-check-label" for="mySwitch">On archive le tournoi?</label>
								</div>

							</div>


							<button type="submit" class="btn btn-primary">Modifier</button>

						</form>
					</div>
				</div>
				<div class="col">
					<div class="row">
						Pour les coachs:
						<a href="GenerateQrCode.php?idTournoi={{infotournoi.id}}" class="btn btn-primary">
							<i class="fa-solid fa-qrcode me-1"></i>QRCODE Publique</a>
					</div>

					
					
					<div class="row">
						Pour les tables :


						{% for i in 1.. AfficherTerrain|length %}
							<a href="GenerateQrCodeTable.php?idTournoi={{infotournoi.id}}&terrain={{AfficherTerrain[i-1].terrain_id}}" class="btn btn-primary">
								<i class="fa-solid fa-qrcode me-1"></i>
								QRCODE table
								{{AfficherTerrain[i-1].nom}}</a><br>

						{% endfor %}
					


					</div>
					
					{% if infotournoi.gestionTables == 1 %}
					<div class="row">
						<div class="col-5">
							<h3>Ajouter une personne pour les tables</h3>
							<form action="modifierTournoi_traitement.php">
							<div class="mb-3">
									<label for="Email" class="form-label">Email address</label>
									<input type="email" class="form-control" id="Email" aria-describedby="emailHelp" name="mail" required>
									<input type="hidden" name="addPersonne" value="true">
									<input type="hidden" name="tournoiId" value="{{infotournoi.id}}">
									<div id="emailHelp" class="form-text">Email</div>
								</div>
								<div class="mb-3">
									<label for="Nom" class="form-label">Nom</label>
									<input type="text" class="form-control" id="Nom" name="nom" required>
								</div>
								<div class="mb-3">
									<label for="prenom" class="form-label">prenom</label>
									<input type="text" class="form-control" id="prenom" name="prenom" required>
								</div>
								<button type="submit" class="btn btn-primary">Ajouter</button>
							</form>
						</div>
					</div>
					<div class="row">
						<div class="col">
							<table class="table">
								<thead>
									<tr>
									
									<th scope="col">nom</th>
									<th scope="col">Prenom</th>
									<th scope="col">mail</th>
									<th scope="col">Terrain N°</th>
									</tr>
								</thead>
								<tbody>
								
								{% for personne in AfficherPersonnes %}
									<tr>
									
									<td>{{personne.Nom}}</td>
									<td>{{personne.Prenom}}</td>
									<td>{{personne.Mail}}</td>
									<td>
										{% for terrain in AfficherTerrain %}
										
									<a href="modifierTournoi_traitement.php?action=ajoutUserSurTable&idPersonne={{personne.id}}&idterrain={{terrain.terrain_id}}&tournoiId={{infotournoi.id}}"><span class="badge rounded-pill bg-success"> {{terrain.nom}}</span></a>
										{% endfor %}
									</td>
									</tr>
								{% endfor %}
								</tbody>
								</table>
						</div>

						<div class="col">
						<table class="table">
								<thead>
									<tr>
									
									<th scope="col">nom</th>
									<th scope="col">Prenom</th>
									<th scope="col">mail</th>
									<th scope="col">Terrain N°</th>
									<th scope="col">Code pin</th>
									<th scope="col">Clé sécurisée</th>
									<th scope="col">envoyer les informations</th>
									<th scope="col">Suppression de cette personne</th>
									</tr>
								</thead>
								<tbody>
								
								{% for personneTable in AfficherLesPersonnesCrees %}
								<tr>
									<td>{{personneTable.Nom}}</td>
									<td>{{personneTable.Prenom}}</td>
									<td>{{personneTable.Mail}}</td>
									<td>{{personneTable.terrain_nom}}</td>
									<td>{{personneTable.code_pin}}</td>
									<td>{{personneTable.url_key}}</td>
									<td class="align-middle"><a href="modifierTournoi_traitement.php?action=sendMail&personneTableId={{personneTable.personne_rencontre_id}}"><i class="fa fa-envelope-o" aria-hidden="true"></i></a></td>
									<td><a href="modifierTournoi_traitement.php?action=delPersonneTable&personneTableId={{personneTable.personne_rencontre_id}}"><i class="fa fa-trash-o" aria-hidden="true"></i></a></td>
									
								</tr>
								{% endfor %}
								</tbody>
								</table>


							
						</div>

					</div>
					{% endif %}
					
					{% if infotournoi.gestionArbitres == 1 %}
					<div class="row">
						<div class="col-5">
							<h3>Ajouter des arbitres</h3>
							<form action="modifierTournoi_traitement.php">
							<div class="mb-3">
									<label for="nomArbitre" class="form-label">Nom</label>
									<input type="email" class="form-control" id="EmailArbitre" aria-describedby="emailHelp" name="EmailArbitre" required>
									<input type="hidden" name="addPersonne" value="true">
									<input type="hidden" name="tournoiId" value="{{infotournoi.id}}">
									<div id="emailHelp" class="form-text">Email</div>
									<label for="nomArbitre" class="form-label">Email address</label>
									<input type="email" class="form-control" id="Email" aria-describedby="emailHelp" name="mail" required>
								</div>					


					{% endif %}

					{% if infotournoi.isArchived == 1 %}
						<div class="row">

							<a class="btn btn-danger btn-sm" href="deleteTournament.php?idTournoi={{infotournoi.id}}&action=delete" onclick="return confirm('Êtes-vous sûr de vouloir supprimer ce tournoi ?\n l\'action est irréversible');">
								<i class="fa-solid fa-trash-can me-1"></i>Suppression du tournoi</a>

						</div>
					{% endif %}


				</div>

				
			{% endif %}




