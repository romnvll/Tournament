<!doctype html>
<html lang="fr">
	<head>
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=0.6"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">		<title>Gestion de la table</title>
		
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
			
			 <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
			 <script src="https://unpkg.com/htmx.org@latest/dist/htmx.min.js"></script>
	</head>

	<body>
		<div class="container-fluid">
		
			
			<div class="row">
			
			Bonjour {{prenom}}, <br> vous êtes en charge d'inserer les scores pour le terrain  {{terrain}}
			</div> 

			<div class="row">
				<div class="col-12" id="scoreRefresh">
					<table class="table table-striped table-responsive">
						<thead>
							<tr>
							
							<th scope="col" class="text-center">Heure</th>
							<th scope="col" class="w-25 text-center">Score equipe1</th>
							<th scope="col" class="w-25 text-center">Score equipe2</th>
							<th scope="col">Arbitre</th>
							<th scope="col">Etat</th>
							</tr>
						</thead>
						
					<tbody>	
       
					{% for planification in AffichagePlanification %}
					<tr id="planification-{{ planification.rencontre_id }}">					

					{% if planification.rencontre_id is not null %}

					<td class="text-center"><h3 class="">{{planification.creneau_nom}}</h3>
					</td>

<form action="vuePersonneTable_traitement.php" method="get" hx-target="#row-{{planification.rencontre_id}}">
  <input type="hidden" name="return_id" value="row-{{planification.rencontre_id}}">
  <td class="text-center">
    <img src="{{planification.club1_logo}}" class="img-fluid rounded">
    <p class="lead text-uppercase">{{planification.equipe1_nom}}</p>
    
    <!-- Champ caché pour scoreEquipe1 -->
    <input type="hidden" name="scoreEquipe1" value="{{planification.score1}}" id="scoreEquipe1{{planification.rencontre_id}}">
    
    <!-- Affichage visuel du score pour l'équipe 1 -->
    <p>Score: <span id="displayScoreEquipe1{{planification.rencontre_id}}">{{planification.score1}}</span></p>
    {% if planification.isTerminated == 0 or planification.isTerminated == 2 %}
    <!-- Boutons pour ajouter ou retirer un but -->
    <button type="button" class="btn btn-success" 
    hx-post="vuePersonneTable_traitement.php?action=addGoal&idRencontre={{planification.rencontre_id}}&team=1" 
    hx-trigger="click" 
     hx-on="htmx:afterRequest:vibrate(50)"
	hx-swap="innerHTML" 
	hx-target="#displayScoreEquipe1{{planification.rencontre_id}}">But +</button>
    <button type="button" class="btn btn-danger" 
    hx-post="vuePersonneTable_traitement.php?action=removeGoal&idRencontre={{planification.rencontre_id}}&team=1" 
     hx-on="htmx:afterRequest:vibrate(200)"
    hx-trigger="click" hx-swap="innerHTML" 
    hx-target="#displayScoreEquipe1{{planification.rencontre_id}}">But -</button>
  </td>
    {% endif %}
  <td class="text-center">
    <img src="{{planification.club2_logo}}" class="img-fluid rounded">
    <p class="lead text-uppercase">{{planification.equipe2_nom}}</p>
    
    <!-- Champ caché pour scoreEquipe2 -->
    <input type="hidden" name="scoreEquipe2" value="{{planification.score2}}" id="scoreEquipe2{{planification.rencontre_id}}">
    
    <!-- Affichage visuel du score pour l'équipe 2 -->
    <p>Score: <span id="displayScoreEquipe2{{planification.rencontre_id}}">{{planification.score2}}</span></p>
    {% if planification.isTerminated == 0 or planification.isTerminated == 2 %}
    <!-- Boutons pour ajouter ou retirer un but -->
    <button type="button" class="btn btn-success" 
    hx-post="vuePersonneTable_traitement.php?action=addGoal&idRencontre={{planification.rencontre_id}}&team=2" 
    hx-trigger="click" 
    hx-on="htmx:afterRequest:vibrate(50)" 

    hx-swap="innerHTML"
    hx-target="#displayScoreEquipe2{{planification.rencontre_id}}"
    >
  But +
</button>
    <button type="button" class="btn btn-danger" hx-post="vuePersonneTable_traitement.php?action=removeGoal&idRencontre={{planification.rencontre_id}}&team=2" 
    hx-trigger="click"
       hx-on="htmx:afterRequest:vibrate(200)" 

    hx-swap="innerHTML"     
    hx-target="#displayScoreEquipe2{{planification.rencontre_id}}"
   >
  But -</button>
  </td>
    {% endif %}
  <td>{{planification.arbitre_nom}}</td>
 <td class="align-left">
  <a class="btn btn-primary" id="State{{planification.rencontre_id}}" role="button"
     hx-trigger="click"
     hx-post="vuePersonneTable_traitement.php?action=updateStatus&idRencontre={{planification.rencontre_id}}"
     hx-target="#State{{planification.rencontre_id}}"
     
     hx-swap="outerHTML">
  
    {% if planification.isTerminated == 0 %}
      À venir
    {% elseif planification.isTerminated == 2 %}
      En cours
    {% else %}
      Terminé
    {% endif %}
  </a>
</td>

</form>




					
					
					
					{% elseif planification.label_description is not null %}
					
					
					
					<td class="w-25 text-center"><h3>{{planification.creneau_nom}}</h3></td>
					<td class="w-25 text-center">{{planification.label_description}} </td>
					<td><p>{{planification.label_description}}<p> </td>
					<td></td>

					{% endif %}
					</tr>
					{% endfor %}
					</tbody>
					
				</table>




			

			</div>
		</div>




	</body>




</html>



<script>
    function vibrate(temps) {
      
        if (navigator.vibrate) {
            navigator.vibrate(temps); // Fait vibrer le téléphone pendant 200 millisecondes
        }
    }


</script>





<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>

<script>
$(document).ready(function () {
      setTimeout(function () {
        // alert('Reloading Page');
        location.reload(true);
      }, 3000);
    });
</script>







